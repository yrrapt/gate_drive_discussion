Version 4
SHEET 1 5224 1044
WIRE 368 -576 224 -576
WIRE 496 -576 368 -576
WIRE 624 -576 496 -576
WIRE 864 -576 752 -576
WIRE 3504 -576 3360 -576
WIRE 3632 -576 3504 -576
WIRE 3760 -576 3632 -576
WIRE 4000 -576 3888 -576
WIRE 624 -528 624 -576
WIRE 864 -528 864 -576
WIRE 3760 -528 3760 -576
WIRE 4000 -528 4000 -576
WIRE 752 -512 752 -576
WIRE 752 -512 672 -512
WIRE 1472 -512 1408 -512
WIRE 1760 -512 1472 -512
WIRE 3888 -512 3888 -576
WIRE 3888 -512 3808 -512
WIRE 160 -464 32 -464
WIRE 224 -464 224 -576
WIRE 224 -464 160 -464
WIRE 368 -464 224 -464
WIRE 752 -464 672 -464
WIRE 3296 -464 3168 -464
WIRE 3360 -464 3360 -576
WIRE 3360 -464 3296 -464
WIRE 3504 -464 3360 -464
WIRE 3888 -464 3808 -464
WIRE 1760 -448 1760 -512
WIRE 1760 -448 1680 -448
WIRE 1408 -432 1408 -512
WIRE 32 -416 32 -464
WIRE 1680 -416 1680 -448
WIRE 1760 -416 1760 -448
WIRE 3168 -416 3168 -464
WIRE 752 -400 752 -464
WIRE 864 -400 864 -448
WIRE 864 -400 752 -400
WIRE 3888 -400 3888 -464
WIRE 4000 -400 4000 -448
WIRE 4000 -400 3888 -400
WIRE 624 -384 624 -448
WIRE 864 -384 864 -400
WIRE 3760 -384 3760 -448
WIRE 4000 -384 4000 -400
WIRE 1680 -304 1680 -352
WIRE 1760 -304 1760 -336
WIRE 1760 -304 1680 -304
WIRE 1472 -288 1472 -512
WIRE 160 -272 160 -464
WIRE 368 -272 368 -464
WIRE 496 -272 496 -576
WIRE 3296 -272 3296 -464
WIRE 3504 -272 3504 -464
WIRE 3632 -272 3632 -576
WIRE -272 -256 -576 -256
WIRE -176 -256 -272 -256
WIRE -144 -256 -176 -256
WIRE 0 -256 -64 -256
WIRE 32 -256 32 -352
WIRE 32 -256 0 -256
WIRE 112 -256 32 -256
WIRE 1760 -256 1760 -304
WIRE 2832 -256 1760 -256
WIRE 2960 -256 2832 -256
WIRE 2992 -256 2960 -256
WIRE 3136 -256 3072 -256
WIRE 3168 -256 3168 -352
WIRE 3168 -256 3136 -256
WIRE 3248 -256 3168 -256
WIRE -176 -224 -176 -256
WIRE 0 -224 0 -256
WIRE 1760 -224 1760 -256
WIRE 1760 -224 1680 -224
WIRE 112 -208 96 -208
WIRE 2960 -208 2960 -256
WIRE 3248 -208 3232 -208
WIRE 1680 -192 1680 -224
WIRE 1760 -192 1760 -224
WIRE -576 -176 -576 -256
WIRE 3136 -144 3136 -256
WIRE 1680 -80 1680 -128
WIRE 1760 -80 1760 -112
WIRE 1760 -80 1680 -80
WIRE -576 -16 -576 -96
WIRE 1472 -16 1472 -208
WIRE 1616 -16 1472 -16
WIRE 1760 -16 1760 -80
WIRE 1760 -16 1616 -16
WIRE -176 16 -176 -144
WIRE 0 16 0 -160
WIRE 0 16 -176 16
WIRE 96 16 96 -208
WIRE 96 16 0 16
WIRE 160 16 160 -192
WIRE 160 16 96 16
WIRE 240 16 160 16
WIRE 368 16 368 -208
WIRE 368 16 240 16
WIRE 496 16 496 -192
WIRE 496 16 368 16
WIRE 624 16 624 -304
WIRE 624 16 496 16
WIRE 2960 16 2960 -128
WIRE 3136 16 3136 -80
WIRE 3136 16 2960 16
WIRE 3232 16 3232 -208
WIRE 3232 16 3136 16
WIRE 3296 16 3296 -192
WIRE 3296 16 3232 16
WIRE 3376 16 3296 16
WIRE 3504 16 3504 -208
WIRE 3504 16 3376 16
WIRE 3632 16 3632 -192
WIRE 3632 16 3504 16
WIRE 3760 16 3760 -304
WIRE 3760 16 3632 16
WIRE 240 48 240 16
WIRE 3376 48 3376 16
WIRE -480 256 -544 256
WIRE -416 256 -480 256
WIRE 3424 320 3280 320
WIRE 3584 320 3424 320
WIRE 3712 320 3584 320
WIRE 3952 320 3840 320
WIRE -544 368 -544 256
WIRE 3712 368 3712 320
WIRE 3952 368 3952 320
WIRE 1472 384 1408 384
WIRE 1760 384 1472 384
WIRE 3840 384 3840 320
WIRE 3840 384 3760 384
WIRE 3840 432 3760 432
WIRE 1760 448 1760 384
WIRE 1760 448 1680 448
WIRE 1408 464 1408 384
WIRE 1680 480 1680 448
WIRE 1760 480 1760 448
WIRE 3280 496 3280 320
WIRE 3840 496 3840 432
WIRE 3952 496 3952 448
WIRE 3952 496 3840 496
WIRE 3712 512 3712 448
WIRE 3952 512 3952 496
WIRE -544 560 -544 448
WIRE 1680 592 1680 544
WIRE 1760 592 1760 560
WIRE 1760 592 1680 592
WIRE 1472 608 1472 384
WIRE 3584 624 3584 320
WIRE 1760 640 1760 592
WIRE 2944 640 1760 640
WIRE 3072 640 2944 640
WIRE 3264 640 3264 592
WIRE 3264 640 3072 640
WIRE 1760 672 1760 640
WIRE 1760 672 1680 672
WIRE 3072 688 3072 640
WIRE 1680 704 1680 672
WIRE 1760 704 1760 672
WIRE 1680 816 1680 768
WIRE 1760 816 1760 784
WIRE 1760 816 1680 816
WIRE 1472 880 1472 688
WIRE 1616 880 1472 880
WIRE 1760 880 1760 816
WIRE 1760 880 1616 880
WIRE 3072 912 3072 768
WIRE 3296 912 3296 592
WIRE 3296 912 3072 912
WIRE 3488 912 3296 912
WIRE 3584 912 3584 704
WIRE 3584 912 3488 912
WIRE 3712 912 3712 592
WIRE 3712 912 3584 912
WIRE 3488 944 3488 912
FLAG -544 560 0
FLAG 2832 -256 gate_model_fetdrive
FLAG 3504 -576 drain_model_fetdrive
FLAG -480 256 drive_sig
FLAG 1408 -432 0
FLAG 1616 -16 vss_model_fetdrive
FLAG 3376 48 0
FLAG -272 -256 gate_model_vdrive
FLAG -576 -16 0
FLAG 240 48 0
FLAG 2944 640 gate_spice_fetdrive
FLAG 3424 320 drain_spice_fetdrive
FLAG 1408 464 0
FLAG 1616 880 vss_spice_fetdrive
FLAG 3488 944 0
FLAG 368 -576 drain_model_vdrive
FLAG 4000 -384 0
FLAG 3952 512 0
FLAG 864 -384 0
SYMBOL sw 3296 -176 M180
SYMATTR InstName S1
SYMATTR Value UF3N120140
SYMBOL cap 3120 -144 R0
SYMATTR InstName Cgs
SYMATTR Value 399p
SYMBOL cap 3488 -272 R0
SYMATTR InstName Cds
SYMATTR Value 4p
SYMBOL cap 3152 -416 R0
SYMATTR InstName Cgd
SYMATTR Value 45p
SYMBOL res 3088 -272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rg
SYMATTR Value 2.4
SYMBOL voltage -544 352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vg
SYMATTR Value PULSE(-1 1 50n 100p 100p 0.05u 0.1u)
SYMBOL bi 1760 -416 R0
SYMATTR InstName B1
SYMATTR Value I={if(v(drive_sig)>0,UpLim(drive_i,(0-V(gate_model_fetdrive))/r_gatedrive,soft_factor),0)}
SYMBOL bi 1760 -192 R0
SYMATTR InstName B2
SYMATTR Value I={if(v(drive_sig)<0,UpLim(drive_i,(V(gate_model_fetdrive)-V(vss_model_fetdrive))/r_gatedrive,soft_factor),0)}
SYMBOL res 2944 -224 R0
SYMATTR InstName R1
SYMATTR Value 1Meg
SYMBOL voltage 1472 -304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vmodel_fetdrive
SYMATTR Value {drive_v}
SYMBOL sw 160 -176 M180
SYMATTR InstName S2
SYMATTR Value UF3N120140
SYMBOL cap -16 -224 R0
SYMATTR InstName Cgs1
SYMATTR Value 399p
SYMBOL cap 352 -272 R0
SYMATTR InstName Cds1
SYMATTR Value 4p
SYMBOL cap 16 -416 R0
SYMATTR InstName Cgd1
SYMATTR Value 45p
SYMBOL res -48 -272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rg1
SYMATTR Value 2.4
SYMBOL res -192 -240 R0
SYMATTR InstName R2
SYMATTR Value 1Meg
SYMBOL bv -576 -192 R0
SYMATTR InstName Bmodel_vdrive
SYMATTR Value V=drive_v*(v(drive_sig)/2-0.5)
SYMBOL bi 3632 -192 M180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName B3
SYMATTR Value I={UpLim(15,(1000-V(drain_model_fetdrive))/50,10)}
SYMBOL AutoGenerated\\UF3N120140Z 3280 544 M90
SYMATTR InstName U1
SYMBOL bi 1760 480 R0
SYMATTR InstName B4
SYMATTR Value I={if(v(drive_sig)>0,UpLim(drive_i,(0-V(gate_spice_fetdrive))/r_gatedrive,soft_factor),0)}
SYMBOL bi 1760 704 R0
SYMATTR InstName B5
SYMATTR Value I={if(v(drive_sig)<0,UpLim(drive_i,(V(gate_spice_fetdrive)-V(vss_spice_fetdrive))/r_gatedrive,soft_factor),0)}
SYMBOL res 3056 672 R0
SYMATTR InstName R3
SYMATTR Value 1Meg
SYMBOL voltage 1472 592 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vspice_fetdrive
SYMATTR Value {drive_v}
SYMBOL bi 3584 704 M180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName B6
SYMATTR Value I={UpLim(15,(1000-V(drain_spice_fetdrive))/50,10)}
SYMBOL voltage 3760 -400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {(1-miller)*1000}
SYMBOL voltage 3712 496 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {(1-miller)*1000}
SYMBOL bi 496 -192 M180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName B7
SYMATTR Value I={miller*UpLim(15,(1000-V(drain_model_vdrive))/50,10)}
SYMBOL voltage 624 -400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value {(1-miller)*1000}
SYMBOL sw 3760 -432 R180
SYMATTR InstName S3
SYMBOL voltage 4000 -544 R0
SYMATTR InstName V4
SYMATTR Value {1-miller}
SYMBOL sw 3712 464 R180
SYMATTR InstName S4
SYMBOL voltage 3952 352 R0
SYMATTR InstName V5
SYMATTR Value {1-miller}
SYMBOL sw 624 -432 R180
SYMATTR InstName S5
SYMBOL voltage 864 -544 R0
SYMATTR InstName V6
SYMATTR Value {1-miller}
SYMBOL cap 1664 -416 R0
SYMATTR InstName C1
SYMATTR Value 10f
SYMBOL cap 1664 -192 R0
SYMATTR InstName C2
SYMATTR Value 10f
SYMBOL cap 1664 480 R0
SYMATTR InstName C3
SYMATTR Value 10f
SYMBOL cap 1664 704 R0
SYMATTR InstName C4
SYMATTR Value 10f
TEXT -584 600 Left 2 !.tran 0 5.1u 0.1u 100p
TEXT -584 648 Left 2 !.model UF3N120140 SW(Ron=0.142 Roff=714Meg Vt=-8.7 Vh=0.1)
TEXT -584 728 Left 2 !.param drive_i=2
TEXT -584 752 Left 2 !.param drive_v=18
TEXT -584 776 Left 2 !.param r_gatedrive=0.1
TEXT 1576 72 Left 2 !.ic v(gate_model_fetdrive)=0
TEXT 1464 968 Left 2 !.ic v(gate_spice_fetdrive)=0
TEXT -584 800 Left 2 !.param soft_factor=10
TEXT -584 880 Left 2 !.param miller=1
TEXT -584 672 Left 2 !.model SW SW(Ron=0.0001 Roff=1000Meg Vt=0.5 Vh=0.1)
